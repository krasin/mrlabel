<html>
<head>
  <script src="images.txt"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script>
  was = {}
  function nextQuestion() {
    while (true) {
      questionIdx = Math.floor(Math.random() * questions.length) % questions.length;
      if (!was[questionIdx]) {
        break;
      }
    }
    was[questionIdx] = true;
    $("#cur_image").attr("src", questions[questionIdx]);
  }
    
  $(document).ready(function() {
    questions = [];
    var lines = images_str.split("\n");
    for (var i = 0; i < lines.length; i++) {
      var line = $.trim(lines[i]);
      if (line == "" || line[0] == ';' || line[0] == '#') {
        continue;
      }
      questions.push(line);
    }
    console.log("loaded " + questions.length + " questions.");
    nextQuestion();
    $("body").keyup(function(event) {
      if (event.which != 48 /*0*/ && event.which != 49 /*1*/) {
        return;
      }
      var ans = (event.which == 48)?"0":"1"
      console.log(questions[questionIdx] + " " + ans);
      $.post("http://localhost:10000/log", { "image": questions[questionIdx], "label": ans })
      nextQuestion();
    });
  });
  </script>
</head>
<body>
  <img id="cur_image" />
</body>
</html>
